<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discharge Summary - Editable PPT</title>
    
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <style>
        /* --- COPY OF YOUR 100% MATCH STYLES --- */
        :root { --green: #1b5e20; --red: #d32f2f; }
        body { background-color: #e0e0e0; font-family: Arial, sans-serif; margin: 0; padding: 40px; display: flex; justify-content: center; }
        .page { background-color: white; width: 210mm; min-height: 297mm; padding: 15mm 15mm; box-shadow: 0 0 15px rgba(0,0,0,0.2); box-sizing: border-box; position: relative; }
        
        /* Headers */
        header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }
        .header-center { text-align: center; flex: 1; display: flex; flex-direction: column; align-items: center; }
        .h-main { color: var(--green); font-size: 26px; font-weight: 700; margin: 0; line-height: 1.2; }
        .header-line { width: 85%; height: 1px; background-color: #000; margin: 5px 0; }
        .h-sub { color: #000; font-size: 17px; font-weight: 600; margin: 0; }
        .h-nabh { color: var(--red); font-size: 14px; font-weight: 700; margin-top: 5px; }
        .logo-box { width: 80px; height: 80px; background: #f4f4f4; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #999; border: 1px dashed #ccc; }
        .doc-title { text-align: center; font-weight: 700; text-decoration: underline; font-size: 13px; margin-bottom: 5px; color: #000; text-transform: uppercase; }

        /* Table */
        table { width: 100%; border-collapse: collapse; font-size: 12px; color: #000; border: 1.5px solid #000; margin-bottom: 20px; table-layout: fixed; }
        td { border: 1px solid #000; padding: 6px 8px; vertical-align: top; line-height: 1.4; }
        .col-1 { width: 45%; } .col-2 { width: 25%; } .col-3 { width: 30%; }
        .lbl-short { font-weight: 700; float: left; margin-right: 5px; }
        .val { font-weight: 600; color: #000; }

        /* Lists */
        .section-title { font-size: 12px; font-weight: 700; text-transform: uppercase; margin-top: 15px; margin-bottom: 5px; color: #000; }
        ul { margin: 0; padding-left: 30px; list-style-type: disc; }
        li { font-size: 12px; font-weight: 500; margin-bottom: 4px; color: #000; }

        /* Controls */
        .btn-container { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 2000; }
        .action-btn { padding: 12px 20px; background-color: #d24726; color: white; border: none; cursor: pointer; font-weight: bold; border-radius: 4px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .action-btn:hover { background-color: #b03518; }
        .print-btn { background-color: #004e46; }

        [contenteditable]:hover { background: #f0f8ff; cursor: text; outline: 1px dashed #ccc; }
    </style>

    <script>
        // --- THIS FUNCTION GENERATES THE EDITABLE PPT ---
        function generateEditablePPT() {
            let pptx = new PptxGenJS();
            
            // 1. Set A4 Page Size (approx 8.27 x 11.69 inches)
            pptx.layout = 'A4';
            let slide = pptx.addSlide();

            // --- HEADER ---
            // Main Title
            slide.addText("Valli Super Speciality Hospital", { 
                x: 0.5, y: 0.5, w: 7.27, h: 0.5, 
                fontSize: 24, color: '1b5e20', bold: true, align: 'center', fontFace: 'Arial' 
            });
            
            // Line
            slide.addShape(pptx.ShapeType.line, { x: 1.0, y: 1.0, w: 6.27, h: 0, line: { color: '000000', width: 1 } });
            
            // Sub Title
            slide.addText("Valli Orthopaedic & Sports Hospital", { 
                x: 0.5, y: 1.05, w: 7.27, h: 0.3, 
                fontSize: 16, color: '000000', bold: true, align: 'center', fontFace: 'Arial' 
            });

            // NABH
            slide.addText("NABH Accredited", { 
                x: 0.5, y: 1.35, w: 7.27, h: 0.3, 
                fontSize: 12, color: 'd32f2f', bold: true, align: 'center', fontFace: 'Arial' 
            });

            // Doc Title
            slide.addText("DISCHARGE SUMMARY", { 
                x: 0.5, y: 1.8, w: 7.27, h: 0.3, 
                fontSize: 12, color: '000000', bold: true, underline: true, align: 'center', fontFace: 'Arial' 
            });

            // --- DATA EXTRACTION ---
            // We grab the text exactly as it is on the screen right now
            let name = document.getElementById('val-name').innerText;
            let mrn = document.getElementById('val-mrn').innerText;
            let ip = document.getElementById('val-ip').innerText;
            let age = document.getElementById('val-age').innerText;
            let sex = document.getElementById('val-sex').innerText;
            let room = document.getElementById('val-room').innerText;
            let address = document.getElementById('val-address').innerText; // Grabs multi-line text
            let phone = document.getElementById('val-phone').innerText;
            let consultants = document.getElementById('val-consultants').innerText;
            let icd = document.getElementById('val-icd').innerText;
            
            // --- TABLE GENERATION ---
            // PptxGenJS Table Rows
            let rows = [
                // Row 1
                [
                    { text: "NAME: " + name, options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "MRN: " + mrn, options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "IP: " + ip, options: { fontFace:'Arial', fontSize:10, bold:true } }
                ],
                // Row 2
                [
                    { text: "AGE: " + age, options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "SEX: " + sex, options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "R.NO: " + room, options: { fontFace:'Arial', fontSize:10, bold:true } }
                ],
                // Row 3 (Address - Spans 3 columns)
                [
                    { text: "ADDRESS: " + address + "\n\nPHONE: " + phone, options: { colspan: 3, fontFace:'Arial', fontSize:10, bold:true, align:'left' } }
                ],
                // Row 4
                [
                    { text: "D.O.A: 21/07/25 @ 05:57 PM", options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "D.O.S: 21/07/25", options: { fontFace:'Arial', fontSize:10, bold:true } },
                    { text: "D.O.D: 24/07/25 @ 03:00 PM", options: { fontFace:'Arial', fontSize:10, bold:true } }
                ],
                // Row 5 (Consultants - Spans 3 columns)
                [
                    { text: "CONSULTANTS: " + consultants, options: { colspan: 3, fontFace:'Arial', fontSize:10, bold:true } }
                ],
                // Row 6 (ICD - Spans 3 columns)
                [
                    { text: "ICD CODE: " + icd, options: { colspan: 3, fontFace:'Arial', fontSize:10, bold:true } }
                ]
            ];

            // Add Table to Slide
            slide.addTable(rows, {
                x: 0.5, y: 2.2, w: 7.27,
                colW: [3.2, 2.0, 2.07], // Column widths roughly matching 45%, 25%, 30%
                border: { pt: 1, color: "000000" },
                valign: "top"
            });

            // --- MEDICAL CONTENT (Lists) ---
            // Helper to add list sections dynamically based on Y position
            let currentY = 6.0; // Start below the table (approx)

            function addSection(title, content) {
                slide.addText(title, { x: 0.5, y: currentY, w: 7, h: 0.3, fontSize: 11, bold: true, underline: false });
                currentY += 0.25;
                
                // Add bullets
                let items = content.split('\n');
                items.forEach(item => {
                    if(item.trim() !== "") {
                         slide.addText(item.trim(), { 
                             x: 0.5, y: currentY, w: 7, h: 0.3, 
                             fontSize: 11, bullet: true, indent: 20 
                         });
                         currentY += 0.25;
                    }
                });
                currentY += 0.2; // Spacer
            }

            // Grab text content from the HTML elements
            let diagText = document.getElementById('sec-diagnosis').innerText;
            let procText = document.getElementById('sec-procedure').innerText;
            let compText = document.getElementById('sec-complaints').innerText;
            let histText = document.getElementById('sec-history').innerText;
            let examText = document.getElementById('sec-exam').innerText;

            addSection("DIAGNOSIS:", diagText);
            addSection("PROCEDURE:", procText);
            addSection("CHIEF COMPLAINTS:", compText);
            addSection("PAST MEDICAL HISTORY:", histText);
            addSection("ON EXAMINATION:", examText);

            // 4. Save
            pptx.writeFile({ fileName: "Editable_Discharge_Summary.pptx" });
        }
    </script>
</head>
<body>

    <div class="btn-container">
        <button class="action-btn" onclick="generateEditablePPT()">Download Editable PPT</button>
        <button class="action-btn print-btn" onclick="window.print()">Print / PDF</button>
    </div>

    <div class="page">
        <header>
            <div class="logo-box">Left Logo</div>
            <div class="header-center">
                <h1 class="h-main" contenteditable="true">Valli Super Speciality Hospital</h1>
                <div class="header-line"></div>
                <h2 class="h-sub" contenteditable="true">Valli Orthopaedic & Sports Hospital</h2>
                <div class="h-nabh" contenteditable="true">NABH Accredited</div>
            </div>
            <div class="logo-box">Right Logo</div>
        </header>

        <div class="doc-title">DISCHARGE SUMMARY</div>

        <table>
            <colgroup><col class="col-1"><col class="col-2"><col class="col-3"></colgroup>
            <tr>
                <td><span class="lbl-short">NAME</span>: <span class="val" id="val-name" contenteditable="true">Mr.TAMILSELVAN.D</span></td>
                <td><span class="lbl-short">MRN.NO</span>: <span class="val" id="val-mrn" contenteditable="true">11948</span></td>
                <td><span class="lbl-short">IP.NO</span>: <span class="val" id="val-ip" contenteditable="true">25000307</span></td>
            </tr>
            <tr>
                <td><span class="lbl-short">AGE</span>: <span class="val" id="val-age" style="margin-left: 14px;" contenteditable="true">29 YEARS</span></td>
                <td><span class="lbl-short">SEX</span>: <span class="val" id="val-sex" style="margin-left: 15px;" contenteditable="true">MALE</span></td>
                <td><span class="lbl-short">R.NO</span>: <span class="val" id="val-room" contenteditable="true">IP-2</span></td>
            </tr>
            <tr>
                <td colspan="3">
                    <div style="margin-bottom: 5px;">
                        <span class="lbl-short" style="width:85px;">ADDRESS :</span>
                        <div class="val" id="val-address" style="margin-left: 85px; font-weight: 600; line-height: 1.4;" contenteditable="true">
                            S/O.MR. DEVARAJI,
                            PALLATHUR,
                            ATHI PADI,
                            UTHANGARAI,
                            KRISHNAGIRI.
                        </div>
                    </div>
                    <div>
                        <span class="lbl-short">PHONE</span>: <span class="val" id="val-phone" contenteditable="true">9843904387</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td><span class="lbl-short">D.O.A</span>: <span class="val" contenteditable="true">21/07/25 @ 05:57 PM</span></td>
                <td><span class="lbl-short">D.O.S</span>: <span class="val" contenteditable="true">21/07/25</span></td>
                <td><span class="lbl-short">D.O.D</span>: <span class="val" contenteditable="true">24/07/25 @ 03:00 PM</span></td>
            </tr>
            <tr>
                <td colspan="3">
                    <span class="lbl-short">CONSULTANTS:</span>
                    <div class="val" id="val-consultants" style="margin-left: 5px; display: inline-block; vertical-align: top;" contenteditable="true">
                        DR.T.NATANASABAPATHY MBBS, M.S(ORTHO), FDFM, IOC DSM
                        DR. AAKASH MBBS., M.S(ORTHO), FIJR, FDFM
                        DR. S. PRADEEP MBBS, MD(ANESTHESIA)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <span class="lbl-short">ICD CODE</span>
                    <span class="val" id="val-icd" style="margin-left: 150px;" contenteditable="true">M00.862</span>
                </td>
            </tr>
        </table>

        <div class="section-title">DIAGNOSIS:</div>
        <ul id="sec-diagnosis" contenteditable="true">
            <li><b>SEPTIC ARTHRITIS - LEFT KNEE</b></li>
        </ul>

        <div class="section-title">PROCEDURE:</div>
        <ul id="sec-procedure" contenteditable="true">
            <li><b>ARTHROSCOPIC DEBRIDEMENT - LEFT KNEE</b></li>
        </ul>

        <div class="section-title">CHIEF COMPLAINTS:</div>
        <ul id="sec-complaints" contenteditable="true">
            <li>Patient came with discharging sinus over operated site</li>
            <li>Patient came for planned debridement under arthroscopy</li>
        </ul>

        <div class="section-title">PAST MEDICAL HISTORY:</div>
        <ul id="sec-history" contenteditable="true">
            <li>Status post Left Arthroscopic ACL Reconstruction x 19 days old</li>
            <li>Patient is typhoid positive since 14.07.2025 on medications</li>
            <li>Patient denies other pre existing medical illness & allergies to any medications</li>
        </ul>

        <div class="section-title">ON EXAMINATION:</div>
        <ul id="sec-exam" contenteditable="true">
            <li>Conscious, Oriented, Afebrile</li>
            <li>Obese</li>
        </ul>

    </div>

</body>
</html>

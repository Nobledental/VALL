<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Form - 7 Col 33 Rows Exact</title>
    <!-- Script for PowerPoint Generation -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Precise colors from the document */
            --green-border: #1a5236; 
            --font-family: 'Roboto', Arial, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .btn-container {
            margin-bottom: 20px;
            display: flex;
            gap: 15px; /* Space between buttons */
        }

        button {
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background 0.3s;
        }

        .btn-ppt { background-color: var(--green-border); }
        .btn-ppt:hover { background-color: #113824; }

        .btn-doc { background-color: #2b579a; } /* Word Blue */
        .btn-doc:hover { background-color: #1e3f72; }

        /* Paper Layout */
        .sheet {
            background-color: white;
            width: 210mm;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Strict Table Grid */
        table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid var(--green-border);
            table-layout: fixed; /* Ensures strict column sizing */
        }

        /* 7 Columns Configuration */
        col.col-label { width: 34%; } /* Label Column */
        col.col-data { width: 11%; }  /* Data Columns (1-6) */

        td {
            border: 1px solid var(--green-border);
            padding: 0 5px; /* Minimal horizontal padding */
            font-size: 11px;
            color: #000;
            vertical-align: middle;
            height: 22px; /* Fixed height for ALL rows to prevent gaps */
            overflow: hidden;
            white-space: nowrap;
        }

        /* Row 1: Header Special Styling */
        .header-row td {
            text-align: center; /* Centered Header */
            border-bottom: 2px solid var(--green-border);
            padding: 5px 10px;
            height: 40px;
        }

        .capsule {
            display: inline-block;
            border: 2px solid var(--green-border);
            border-radius: 20px;
            padding: 4px 15px;
            background-color: white; /* Clean white background */
            color: var(--green-border);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 13px;
        }

        /* Typography */
        .bold { font-weight: 700; }
        .sub { padding-left: 10px; } /* Indentation for sub-items */
        
        /* Ensure no extra margins on rows */
        tr { margin: 0; padding: 0; }

    </style>
</head>
<body>

    <div class="btn-container">
        <button class="btn-ppt" onclick="exportStrictPPT()">Download PowerPoint (.pptx)</button>
        <button class="btn-doc" onclick="exportDoc()">Download Word Doc (.doc)</button>
    </div>

    <!-- The exact HTML to be exported -->
    <div class="sheet" id="printableArea">
        <table>
            <colgroup>
                <col class="col-label">
                <col class="col-data"><col class="col-data"><col class="col-data">
                <col class="col-data"><col class="col-data"><col class="col-data">
            </colgroup>
            <tbody>
                <!-- ROW 1: Header -->
                <tr class="header-row">
                    <td colspan="7">
                        <span class="capsule">TRANSFER INSIDE THE HOSPITAL</span>
                    </td>
                </tr>

                <!-- ROWS 2-33: Content -->
                <tr><td class="bold">DATE:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">TIME:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">FROM:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">TO:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">PURPOSE:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                
                <!-- Vitals -->
                <tr><td class="bold">VITALS:</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">TEMP</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">PULSE</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">B.P</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">SPO2</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">R.R</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                
                <!-- Investigations -->
                <tr><td class="bold">INVESTIGATION</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">a) Blood test reports</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">b) C/S reports</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">c) Pus culture reports</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">d) Others specimen reports</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">e) Biopsy reports</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">X-RAY</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">CT-SCAN, MRI</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">USG</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">DOPPLER</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">ECHO</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">OTHERS</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="sub">Others: e.g. E.T, Cvp...</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                
                <!-- Signatures -->
                <tr><td class="bold">TAKEN OVER NURSE SIGN</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="bold">HAND OVER NURSE SIGN</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                
                <!-- Blank Rows to reach exactly 33 -->
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
        </table>
    </div>

    <script>
        // --- PPT EXPORT FUNCTION ---
        function exportStrictPPT() {
            try {
                if (typeof PptxGenJS === 'undefined') {
                    alert("PowerPoint library is still loading. Please wait a moment and try again.");
                    return;
                }

                let pres = new PptxGenJS();
                
                // --- CONSTANTS ---
                const C_GREEN = "1a5236";
                
                // --- STYLES ---
                const borderOpts = { type: 'solid', color: C_GREEN, pt: 0.75 };
                
                const stBase = { fontFace: "Arial", fontSize: 10, color: "000000", valign: "middle" };
                const stBold = { ...stBase, bold: true };
                const stSub = { ...stBase, fontSize: 10 }; // Regular weight
                
                // Helper for Empty Cells
                const empty = () => ({ text: "", options: { border: borderOpts } });
                const sixEmpties = [empty(), empty(), empty(), empty(), empty(), empty()];

                // --- DATA CONSTRUCTION ---
                let rows = [];

                // 1. Header Row (Placeholder for Overlay)
                rows.push([
                    { text: "", options: { colspan: 7, border: { color: C_GREEN, pt: 0.1 }, h: 0.6 } }, 
                    null, null, null, null, null, null
                ]);

                // Helper to build rows
                const buildRow = (txt, isBold=true) => {
                    let opt = isBold ? stBold : stSub;
                    return [
                        { text: txt, options: { ...opt, border: borderOpts, align: 'left' } },
                        ...sixEmpties
                    ];
                };

                // 2. Exact Data Rows
                rows.push(...[
                    buildRow("DATE:"),
                    buildRow("TIME:"),
                    buildRow("FROM:"),
                    buildRow("TO:"),
                    buildRow("PURPOSE:"),
                    
                    buildRow("VITALS:"),
                    buildRow("TEMP"),
                    buildRow("PULSE"),
                    buildRow("B.P"),
                    buildRow("SPO2"),
                    buildRow("R.R"),
                    
                    buildRow("INVESTIGATION"),
                    buildRow("  a) Blood test reports", false),
                    buildRow("  b) C/S reports", false),
                    buildRow("  c) Pus culture reports", false),
                    buildRow("  d) Others specimen reports", false),
                    buildRow("  e) Biopsy reports", false),
                    buildRow("X-RAY"),
                    buildRow("CT-SCAN, MRI"),
                    buildRow("USG"),
                    buildRow("DOPPLER"),
                    buildRow("ECHO"),
                    buildRow("OTHERS"),
                    buildRow("  Others: e.g. E.T, Cvp...", false),
                    
                    buildRow("TAKEN OVER NURSE SIGN"),
                    buildRow("HAND OVER NURSE SIGN"),
                    
                    // 6 Blank Rows
                    buildRow(" ", false),
                    buildRow(" ", false),
                    buildRow(" ", false),
                    buildRow(" ", false),
                    buildRow(" ", false),
                    buildRow(" ", false)
                ]);

                // --- GENERATE SLIDE ---
                let slide = pres.addSlide();

                // Draw Table
                slide.addTable(rows, {
                    x: 0.5, y: 0.5,
                    w: 9.0, // Fits A4ish landscape on slide
                    colW: [3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], // Exact 7 columns
                    rowH: 0.22, // Uniform height
                    border: borderOpts
                });

                // Draw Header Capsule (Overlay)
                slide.addShape(pres.ShapeType.roundRect, {
                    text: { text: "TRANSFER INSIDE THE HOSPITAL", options: { color: C_GREEN, bold: true, fontSize: 12 } },
                    x: 3.3, y: 0.62, w: 3.4, h: 0.35,
                    fill: { color: "FFFFFF" },
                    line: { color: C_GREEN, width: 1.5 },
                    rectRadius: 1
                });

                pres.writeFile({ fileName: "Hospital_Transfer_Form_Exact.pptx" });
            } catch (err) {
                console.error(err);
                alert("An error occurred while exporting PPT. Please check console for details.");
            }
        }

        // --- DOC EXPORT FUNCTION ---
        function exportDoc() {
            var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                         "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                         "xmlns='http://www.w3.org/TR/REC-html40'>" +
                         "<head><meta charset='utf-8'><title>Export HTML to Word Document with CSS</title></head><body>";
            
            var footer = "</body></html>";
            
            // Get the HTML of the table
            var sourceHTML = header + document.getElementById("printableArea").innerHTML + footer;

            // Embed Styles for Word
            // Note: Word doesn't support external CSS well, so we embed vital styles
            var styles = `
                <style>
                    table { width: 100%; border-collapse: collapse; border: 2px solid #1a5236; font-family: Arial, sans-serif; }
                    td { border: 1px solid #1a5236; padding: 2px 5px; font-size: 11px; height: 22px; color: black; }
                    .header-row td { text-align: center; height: 40px; border-bottom: 2px solid #1a5236; }
                    .capsule { display: inline-block; border: 2px solid #1a5236; border-radius: 20px; padding: 4px 15px; color: #1a5236; font-weight: bold; font-size: 13px; text-transform: uppercase; background: white; }
                    .bold { font-weight: bold; }
                    .sub { padding-left: 10px; }
                </style>
            `;
            
            sourceHTML = header + styles + document.getElementById("printableArea").innerHTML + footer;
            
            var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
            var fileDownload = document.createElement("a");
            document.body.appendChild(fileDownload);
            fileDownload.href = source;
            fileDownload.download = 'Hospital_Transfer_Form.doc';
            fileDownload.click();
            document.body.removeChild(fileDownload);
        }
    </script>
</body>
</html>
